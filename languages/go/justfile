# Go Language Justfile
# Works for any year

# Get the root directory and language template directory
root_dir := justfile_directory() / ".." / ".."
template_dir := justfile_directory() / "template"

# Create a new day
create year day:
  #!/usr/bin/env bash
  set -euo pipefail
  
  year_dir="{{root_dir}}/{{year}}/go"
  mkdir -p "$year_dir/{{day}}/inputs"
  
  # Copy and process templates
  for template in {{template_dir}}/*.tmpl; do
    filename=$(basename "$template" .tmpl)
    if [[ "$filename" == "go.mod" ]]; then
      sed 's/{{{{.Day}}}}/{{day}}/g' "$template" > "$year_dir/{{day}}/$filename"
    else
      cp "$template" "$year_dir/{{day}}/$filename"
    fi
  done
  
  # Create empty input files
  touch "$year_dir/{{day}}/inputs/input1.txt"
  touch "$year_dir/{{day}}/inputs/input2.txt"
  touch "$year_dir/{{day}}/inputs/test1.txt"
  touch "$year_dir/{{day}}/inputs/test2.txt"
  
  echo "Created {{year}}/go/{{day}} with template files"

# Get inputs for a day
get-inputs year day:
  {{root_dir}}/scripts/get-inputs.sh --day {{day}} --year {{year}} --root-dir {{root_dir}}/{{year}}/go

# Run a solution
run year day part:
  cd {{root_dir}}/{{year}}/go/{{day}} && go run part{{part}}.go

# Test a specific part
test year day part:
  cd {{root_dir}}/{{year}}/go/{{day}} && go test -v -run TestPart{{part}}

# Test all parts
test-all year day:
  cd {{root_dir}}/{{year}}/go/{{day}} && go test -v
